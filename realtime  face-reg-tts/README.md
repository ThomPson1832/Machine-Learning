# 实时人脸识别与语音播报系统

这是一个基于Python的实时人脸识别系统，能够通过摄像头实时检测和识别人脸，并使用中文语音合成（TTS）播报识别到的人员姓名。系统具备智能去重、多人识别策略和异常处理功能。

## 功能特点

- **实时人脸识别**：使用摄像头实时检测和识别人脸
- **中文语音播报**：识别成功后自动用中文语音播报姓名
- **智能去重**：避免短时间内重复播报同一个人
- **多人识别策略**：当同时识别到多人时，采用优雅的播报方式
- **人脸注册工具**：提供简单的人脸注册界面
- **异常处理与日志记录**：完善的错误处理和详细的日志记录
- **资源占用优化**：可配置的帧处理间隔，降低CPU占用

## 系统要求

- Python 3.6+
- Windows系统（pyttsx3在Windows上中文支持较好）
- 摄像头

## 安装步骤

1. 克隆或下载项目到本地
2. 安装依赖包：
   ```
   pip install -r requirements.txt
   ```

## 使用方法

### 1. 注册人脸

在使用系统前，需要先注册人脸信息。有两种方式：

#### 从摄像头注册：
```
python register_face.py --name 张三
```
然后按照提示面对摄像头，按空格键拍照注册。

#### 从照片文件注册：
```
python register_face.py --name 李四 --file path/to/photo.jpg
```

### 2. 运行人脸识别系统

```
python main.py
```
系统会自动启动摄像头，开始实时人脸识别。当识别到已注册的人脸时，会用语音播报姓名。

- 按 'q' 键退出系统

## 配置说明

主要配置参数在 `config.py` 文件中：

- `RECOGNITION_TOLERANCE`：人脸识别阈值，越低越严格（默认0.6）
- `CAMERA_ID`：摄像头ID（默认0）
- `FRAME_PROCESS_INTERVAL`：处理帧间隔，降低CPU占用（默认5）
- `MIN_REPEAT_INTERVAL`：最短重复播报间隔（默认5分钟）
- `MAX_ANNOUNCE_COUNT`：单次最多播报人数（默认3）
- `ANNOUNCE_DELAY`：多人播报时的延迟时间（默认1秒）

## 项目结构

- `main.py`：主程序入口
- `face_recognition_system.py`：人脸识别系统核心
- `face_database.py`：人脸数据库管理
- `tts_engine.py`：语音合成引擎
- `announcement_manager.py`：智能播报管理
- `register_face.py`：人脸注册工具
- `config.py`：配置文件
- `logger.py`：日志模块
- `face_database/`：存储人脸照片和编码数据
- `logs/`：存储系统日志

## 注意事项

1. 确保在光线良好的环境下使用，以提高识别准确率
2. 人脸注册时保持正面、表情自然
3. 如果语音播报没有中文，请确保系统已安装中文语音包
4. 定期检查日志文件，了解系统运行状态

## 故障排除

- **摄像头无法打开**：检查摄像头连接和权限，尝试修改 `config.py` 中的 `CAMERA_ID`
- **人脸识别不准确**：调整 `RECOGNITION_TOLERANCE` 参数，或重新注册人脸
- **没有中文语音**：确认系统已安装中文语音包，或尝试更新 pyttsx3
- **系统崩溃**：查看 `logs` 目录下的日志文件了解详细错误信息

## 许可证

本项目仅供学习和研究使用。